(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{t9QY:function(e,t,n){"use strict";n.r(t);var i=n("ofXK"),s=n("tyNb"),a=n("quSY");class r extends a.a{constructor(e,t){super()}schedule(e,t=0){return this}}class c extends r{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(i,this.id,t),this}requestAsyncId(e,t,n=0){return setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let n=!1,i=void 0;try{this.work(e)}catch(s){n=!0,i=!!s&&s||new Error(s)}if(n)return this.unsubscribe(),i}_unsubscribe(){const e=this.id,t=this.scheduler,n=t.actions,i=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&n.splice(i,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let o=(()=>{class e{constructor(t,n=e.now){this.SchedulerAction=t,this.now=n}schedule(e,t=0,n){return new this.SchedulerAction(this,e).schedule(n,t)}}return e.now=()=>Date.now(),e})();class l extends o{constructor(e,t=o.now){super(e,()=>l.delegate&&l.delegate!==this?l.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,n){return l.delegate&&l.delegate!==this?l.delegate.schedule(e,t,n):super.schedule(e,t,n)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const d=new l(c);var p=n("7o/Q"),b=n("EY2u"),u=n("LRne"),h=n("HDdC");let g=(()=>{class e{constructor(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}}accept(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)}toObservable(){switch(this.kind){case"N":return Object(u.a)(this.value);case"E":return e=this.error,new h.a(t=>t.error(e));case"C":return Object(b.b)()}var e;throw new Error("unexpected notification kind value")}static createNext(t){return void 0!==t?new e("N",t):e.undefinedValueNotification}static createError(t){return new e("E",void 0,t)}static createComplete(){return e.completeNotification}}return e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e})();class f{constructor(e,t){this.delay=e,this.scheduler=t}call(e,t){return t.subscribe(new w(e,this.delay,this.scheduler))}}class w extends p.a{constructor(e,t,n){super(e),this.delay=t,this.scheduler=n,this.queue=[],this.active=!1,this.errored=!1}static dispatch(e){const t=e.source,n=t.queue,i=e.scheduler,s=e.destination;for(;n.length>0&&n[0].time-i.now()<=0;)n.shift().notification.observe(s);if(n.length>0){const t=Math.max(0,n[0].time-i.now());this.schedule(e,t)}else this.unsubscribe(),t.active=!1}_schedule(e){this.active=!0,this.destination.add(e.schedule(w.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))}scheduleNotification(e){if(!0===this.errored)return;const t=this.scheduler,n=new v(t.now()+this.delay,e);this.queue.push(n),!1===this.active&&this._schedule(t)}_next(e){this.scheduleNotification(g.createNext(e))}_error(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()}_complete(){this.scheduleNotification(g.createComplete()),this.unsubscribe()}}class v{constructor(e,t){this.time=e,this.notification=t}}var m=n("vkgz"),_=n("fXoL"),y=n("2Vo4"),x=n("lJxs"),P=n("eIep"),O=n("JIr8"),J=n("9rBi");let K=(()=>{class e{constructor(e){this._swapi=e,this._planets$=new y.a([]),this.planets$=this._planets$.asObservable(),this.planetsByPage=10,this._alreadyLoadedPages=[],this._alreadyLoadedPlanets=[]}get planets(){return this._planets$.getValue()}getPlanets(e){return this._isPageAlreadyLoaded(e)?this._planets$.pipe(Object(x.a)(t=>t.filter(t=>t.idx>=(e-1)*this.planetsByPage&&t.idx<e*this.planetsByPage))):this.loadByPage(e).pipe(Object(P.a)(()=>this._planets$),Object(x.a)(t=>t.filter(t=>t.idx>=(e-1)*this.planetsByPage&&t.idx<e*this.planetsByPage)))}getPlanetById(e){return this._isPlanetAlreadyLoaded(e)?this._planets$.pipe(Object(x.a)(t=>t.find(t=>t.id===e))):this.loadById(e).pipe(Object(P.a)(()=>this._planets$),Object(x.a)(t=>t.find(t=>t.id===e)))}_isPageAlreadyLoaded(e){return this._alreadyLoadedPages.includes(e)}_isPlanetAlreadyLoaded(e){return this._alreadyLoadedPlanets.includes(e)}loadByPage(e){return this._swapi.getPlanets({page:e}).pipe(Object(O.a)(()=>Object(u.a)(null)),Object(m.a)(e=>{this.planetsByPage=e.results.length,this.totalPages=e.count/this.planetsByPage}),Object(x.a)(this._mapPlanets.bind(this)),Object(m.a)(t=>{const n=[...this.planets.filter(e=>!t.map(e=>e.id).includes(e.id)),...t];this._planets$.next(n),this._alreadyLoadedPlanets=n.map(e=>e.id),this._alreadyLoadedPages.push(e)}))}loadById(e){return this._swapi.getSinglePlanet(e).pipe(Object(O.a)(()=>Object(u.a)(null)),Object(x.a)(this._mapSinglePlanet.bind(this)),Object(m.a)(e=>{if(!e)return;const t=[...this.planets];t.map(e=>e.id).includes(e.id)||t.push(e),this._planets$.next(t),this._alreadyLoadedPlanets=t.map(e=>e.id)}))}_mapPlanets(e){return e?e.results.map(this._mapSinglePlanet.bind(this)):[]}_mapSinglePlanet(e){return e?{id:+/[^/]*$/.exec(e.url.substring(0,e.url.length-1))[0],idx:+/[^/]*$/.exec(e.url.substring(0,e.url.length-1))[0]-1,name:e.name,rotation_period:e.rotation_period,diameter:e.diameter,climate:e.climate,gravity:e.gravity,terrain:e.terrain,population:e.population,residents:e.residents.map(e=>+/[^/]*$/.exec(e.substring(0,e.length-1))[0])}:null}}return e.\u0275fac=function(t){return new(t||e)(_.Nb(J.a))},e.\u0275prov=_.Bb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const j=["*"];let I=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=_.zb({type:e,selectors:[["app-planets-header"]],inputs:{page:"page"},ngContentSelectors:j,decls:3,vars:0,consts:[[1,"header"],[1,"container"]],template:function(e,t){1&e&&(_.Yb(),_.Kb(0,"header",0),_.Kb(1,"div",1),_.Xb(2),_.Jb(),_.Jb())},styles:[".header[_ngcontent-%COMP%]{padding:25px 0;background-color:#272b30;font-size:22px;text-align:center;color:#fff}"]}),e})();const C=function(e){return["/","planets",e]};let M=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=_.zb({type:e,selectors:[["app-planet-preview"]],inputs:{planet:"planet"},decls:15,vars:6,consts:[[1,"planet"],[1,"planet__name"],[1,"row"],[1,"planet__climate"],[1,"planet__population"],[1,"actions"],[1,"btn","btn--sm",3,"routerLink"]],template:function(e,t){1&e&&(_.Kb(0,"div",0),_.Kb(1,"div",1),_.ic(2),_.Jb(),_.Kb(3,"div",2),_.Kb(4,"div",3),_.ic(5,"Climate: "),_.Kb(6,"b"),_.ic(7),_.Jb(),_.Jb(),_.Kb(8,"div",4),_.ic(9,"Population: "),_.Kb(10,"b"),_.ic(11),_.Jb(),_.Jb(),_.Jb(),_.Kb(12,"div",5),_.Kb(13,"a",6),_.ic(14,"More"),_.Jb(),_.Jb(),_.Jb()),2&e&&(_.wb(2),_.jc(t.planet.name),_.wb(5),_.jc(t.planet.climate),_.wb(4),_.jc(t.planet.population),_.wb(2),_.Zb("routerLink",_.ac(4,C,t.planet.id)))},directives:[s.d],styles:[".planet[_ngcontent-%COMP%]{padding:20px;border-radius:10px;background-color:#fff;margin-bottom:20px}.planet__name[_ngcontent-%COMP%]{font-size:22px;margin-bottom:10px;font-weight:700;text-align:center}.row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.actions[_ngcontent-%COMP%]{margin-top:20px;text-align:center}"]}),e})();var k=n("6fPx");function L(e,t){1&e&&_.Gb(0,"app-planet-preview",7),2&e&&_.Zb("planet",t.$implicit)}function N(e,t){if(1&e&&(_.Ib(0),_.gc(1,L,1,1,"app-planet-preview",6),_.Hb()),2&e){const e=t.ngIf;_.wb(1),_.Zb("ngForOf",e)}}function $(e,t){1&e&&_.Gb(0,"app-preloader")}function B(e,t){if(1&e&&(_.Kb(0,"div",3),_.gc(1,N,2,1,"ng-container",4),_.Vb(2,"async"),_.gc(3,$,1,0,"ng-template",null,5,_.hc),_.Jb()),2&e){const e=t.$implicit,n=_.cc(4);_.wb(1),_.Zb("ngIf",_.Wb(2,2,e))("ngIfElse",n)}}function E(e,t){if(1&e){const e=_.Lb();_.Kb(0,"button",10),_.Rb("click",(function(){return _.dc(e),_.Ub(2).loadNext()})),_.ic(1,"Load more"),_.Jb()}}function F(e,t){if(1&e&&(_.Kb(0,"div",8),_.gc(1,E,2,0,"button",9),_.Jb()),2&e){const e=_.Ub();_.wb(1),_.Zb("ngIf",e.planets.totalPages>e.currentPage)}}let A=(()=>{class e{constructor(e){this.planets=e,this.currentPage=0,this.list$=[]}ngOnInit(){this.loadNext()}loadNext(){this.isLoadingMore=!0,this.currentPage++,this.list$.push(this.planets.getPlanets(this.currentPage).pipe(function(e,t=d){var n;const i=(n=e)instanceof Date&&!isNaN(+n)?+e-t.now():Math.abs(e);return e=>e.lift(new f(i,t))}(0),Object(m.a)(()=>this.isLoadingMore=!1)))}}return e.\u0275fac=function(t){return new(t||e)(_.Fb(K))},e.\u0275cmp=_.zb({type:e,selectors:[["app-planets-page"]],decls:7,vars:3,consts:[[1,"container"],["class","row",4,"ngFor","ngForOf"],["class","actions",4,"ngIf"],[1,"row"],[4,"ngIf","ngIfElse"],["loading",""],[3,"planet",4,"ngFor","ngForOf"],[3,"planet"],[1,"actions"],["type","button","class","btn",3,"click",4,"ngIf"],["type","button",1,"btn",3,"click"]],template:function(e,t){1&e&&(_.Kb(0,"app-planets-header"),_.ic(1," Current page: "),_.Kb(2,"b"),_.ic(3),_.Jb(),_.Jb(),_.Kb(4,"div",0),_.gc(5,B,5,4,"div",1),_.gc(6,F,2,1,"div",2),_.Jb()),2&e&&(_.wb(3),_.jc(t.currentPage),_.wb(2),_.Zb("ngForOf",t.list$),_.wb(1),_.Zb("ngIf",!t.isLoadingMore))},directives:[I,i.i,i.j,M,k.a],pipes:[i.b],styles:["[_nghost-%COMP%]{display:block;padding-top:100px;padding-bottom:50px}.row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;flex-wrap:wrap;margin:0 -15px}.row[_ngcontent-%COMP%]   app-planet-preview[_ngcontent-%COMP%]{display:block;flex:1 0 25%;padding:0 15px}.actions[_ngcontent-%COMP%]{text-align:center}app-planets-header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%}"]}),e})();var Z=n("PCNd"),z=n("itXk"),S=n("tUhB");const V=function(e){return["/","residents",e]};let q=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=_.zb({type:e,selectors:[["app-resident-preview"]],inputs:{resident:"resident"},decls:19,vars:7,consts:[[1,"resident"],[1,"resident__name"],[1,"row"],[1,"resident__param"],[1,"actions"],[1,"btn","btn--sm",3,"routerLink"]],template:function(e,t){1&e&&(_.Kb(0,"div",0),_.Kb(1,"div",1),_.ic(2),_.Jb(),_.Kb(3,"div",2),_.Kb(4,"div",3),_.ic(5,"Height: "),_.Kb(6,"b"),_.ic(7),_.Jb(),_.Jb(),_.Kb(8,"div",3),_.ic(9,"Mass: "),_.Kb(10,"b"),_.ic(11),_.Jb(),_.Jb(),_.Kb(12,"div",3),_.ic(13,"Gender: "),_.Kb(14,"b"),_.ic(15),_.Jb(),_.Jb(),_.Jb(),_.Kb(16,"div",4),_.Kb(17,"a",5),_.ic(18,"More"),_.Jb(),_.Jb(),_.Jb()),2&e&&(_.wb(2),_.jc(t.resident.name),_.wb(5),_.jc(t.resident.height),_.wb(4),_.jc(t.resident.mass),_.wb(4),_.jc(t.resident.gender),_.wb(2),_.Zb("routerLink",_.ac(5,V,t.resident.id)))},directives:[s.d],styles:[".resident[_ngcontent-%COMP%]{padding:20px;border-radius:0;color:#fff;margin-bottom:20px;background-color:#272b30;min-width:200px}.resident__name[_ngcontent-%COMP%]{font-size:22px;margin-bottom:10px;font-weight:700;text-align:center}.actions[_ngcontent-%COMP%]{margin-top:20px;text-align:center}.resident__param[_ngcontent-%COMP%]{margin-bottom:10px;text-align:center}"]}),e})();function G(e,t){1&e&&_.Gb(0,"app-resident-preview",10),2&e&&_.Zb("resident",t.$implicit)}function D(e,t){if(1&e&&(_.Ib(0),_.gc(1,G,1,1,"app-resident-preview",9),_.Hb()),2&e){const e=t.ngIf;_.wb(1),_.Zb("ngForOf",e)}}function H(e,t){1&e&&_.Gb(0,"app-preloader")}function R(e,t){if(1&e&&(_.Ib(0),_.Kb(1,"div",3),_.ic(2),_.Jb(),_.Kb(3,"div",4),_.Kb(4,"div",5),_.ic(5,"Rotation period:"),_.Jb(),_.Kb(6,"div",6),_.ic(7),_.Jb(),_.Jb(),_.Kb(8,"div",4),_.Kb(9,"div",5),_.ic(10,"Diameter:"),_.Jb(),_.Kb(11,"div",6),_.ic(12),_.Jb(),_.Jb(),_.Kb(13,"div",4),_.Kb(14,"div",5),_.ic(15,"Climate:"),_.Jb(),_.Kb(16,"div",6),_.ic(17),_.Jb(),_.Jb(),_.Kb(18,"div",4),_.Kb(19,"div",5),_.ic(20,"Gravity:"),_.Jb(),_.Kb(21,"div",6),_.ic(22),_.Jb(),_.Jb(),_.Kb(23,"div",4),_.Kb(24,"div",5),_.ic(25,"Terrain:"),_.Jb(),_.Kb(26,"div",6),_.ic(27),_.Jb(),_.Jb(),_.Kb(28,"div",4),_.Kb(29,"div",5),_.ic(30,"Population:"),_.Jb(),_.Kb(31,"div",6),_.ic(32),_.Jb(),_.Jb(),_.Kb(33,"div",7),_.gc(34,D,2,1,"ng-container",1),_.Vb(35,"async"),_.gc(36,H,1,0,"ng-template",null,8,_.hc),_.Jb(),_.Hb()),2&e){const e=t.ngIf,n=_.cc(37);_.wb(2),_.jc(e.name),_.wb(5),_.jc(e.rotation_period),_.wb(5),_.jc(e.diameter),_.wb(5),_.jc(e.climate),_.wb(5),_.jc(e.gravity),_.wb(5),_.jc(e.terrain),_.wb(5),_.jc(e.population),_.wb(2),_.Zb("ngIf",_.Wb(35,9,e.residents))("ngIfElse",n)}}function X(e,t){1&e&&_.Gb(0,"app-preloader",11)}let Y=(()=>{class e{constructor(e,t,n,i){this._route=e,this._planets=t,this._residents=n,this._router=i,this.planet$=this._route.params.pipe(Object(P.a)(e=>this._planets.getPlanetById(+e.id)),Object(x.a)(e=>e?Object.assign(Object.assign({},e),{residents:e.residents.length?Object(z.a)(e.residents.map(e=>this._residents.getResidentById(e))):Object(u.a)([])}):(this._router.navigate(["/","404"]),Object(u.a)(null))))}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(_.Fb(s.a),_.Fb(K),_.Fb(S.a),_.Fb(s.c))},e.\u0275cmp=_.zb({type:e,selectors:[["app-planet-single-page"]],decls:5,vars:4,consts:[[1,"container"],[4,"ngIf","ngIfElse"],["loading",""],[1,"page-title"],[1,"param"],[1,"param__title"],[1,"param__value"],[1,"residents"],["resLoading",""],[3,"resident",4,"ngFor","ngForOf"],[3,"resident"],[1,"main-preloader"]],template:function(e,t){if(1&e&&(_.Kb(0,"div",0),_.gc(1,R,38,11,"ng-container",1),_.Vb(2,"async"),_.gc(3,X,1,0,"ng-template",null,2,_.hc),_.Jb()),2&e){const e=_.cc(4);_.wb(1),_.Zb("ngIf",_.Wb(2,2,t.planet$))("ngIfElse",e)}},directives:[i.j,i.i,q,k.a],pipes:[i.b],styles:[".param[_ngcontent-%COMP%]{display:flex;width:300px;justify-content:space-between;margin-bottom:20px;color:#fff}.param__value[_ngcontent-%COMP%]{font-size:16px;font-weight:700}.residents[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-top:40px}app-resident-preview[_ngcontent-%COMP%]{display:block;margin-right:10px}.main-preloader[_ngcontent-%COMP%]{margin:50px 0}"]}),e})();n.d(t,"PlanetsModule",(function(){return U}));let U=(()=>{class e{}return e.\u0275mod=_.Db({type:e}),e.\u0275inj=_.Cb({factory:function(t){return new(t||e)},imports:[[i.c,Z.a,s.e.forChild([{path:"",component:A},{path:":id",component:Y}])],s.e]}),e})()}}]);